theory asym_key_PFS
begin


protocol PFS
{
  1. A ->  : {'1', B, pk(na)}sk(A)
       -> B: {'1', B, pkNa  }sk(A)

  2.   <- B: { {'2', A, k}sk(B) }pkNa
     A <-  : { {'2', A, k}sk(B) }pk(na)
}

properties (of PFS)
  auto: msc-typing

  B_sec_k: secret(B, -, k, {A,B} )
  A_sec_k: secret(A, 2, k, {A,B} )

end
